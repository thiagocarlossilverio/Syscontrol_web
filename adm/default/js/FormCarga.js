$(function () {    $('#caminhao').after('<span  class="glyphicon glyphicon-plus-sign btincluir incluirCaminhao"></span>');    $('#categoria').after('<span  class="glyphicon glyphicon-plus-sign btincluir incluirCategoria"></span>');    /*Adiciono os botões de incluir e limpar campo a baixado campo peso bruto*/    $('#peso_bruto').after('<span  class="glyphicon glyphicon-screenshot btincluir bt_inclui_peso_bruto"></span>');    $('#peso_bruto').after('<span  class="glyphicon glyphicon-remove-circle btincluir bt_limpa_peso_bruto"></span>');    /*Adiciono os botões de incluir e limpar campo a baixado campo peso tara*/    $('#peso_tara').after('<span  class="glyphicon glyphicon-screenshot btincluir bt_inclui_peso_tara"></span>');    $('#peso_tara').after('<span  class="glyphicon glyphicon-remove-circle btincluir bt_limpa_peso_tara"></span>');    /*Adiciono a mascara nos campos de peso*/    $.getScript('/adm/default/js/lib/jquery.mask.min.js', function () {        $('#peso_tara, #peso_bruto, #peso_nota').mask('###.##0', {reverse: true, placeholder: "0.000"});    });    /*Adiciona as mascaras nos campos*/    $.getScript('/adm/default/js/lib/mascaras.js', function () {        $.getScript('/adm/default/js/timepicker.js', function () {            $("#data_entrada, #data_saida").mask("99/99/9999 99:99");            $("#data_entrada, #data_saida").datetimepicker({                dateFormat: "dd/mm/yy",                dayNamesMin: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"],                monthNames: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"]});        });    });    /*Ao editar*/    if ($('#id').val() !== '') {        /*Verifico se o peso tara está diferente de vazio e preencho os radio button*/        if ($('#peso_bruto').val() !== '' && $('#peso_bruto').val() > '0.00') {            $("#carregado-1").prop("checked", false);            $("#carregado-0").prop("checked", true);        } else {            $("#carregado-1").prop("checked", true);            $("#carregado-0").prop("checked", false);        }        /*ao editar se o caminhão estiver carregado oculto o campo peso tara*/        if ($('input:checked').val() == '1') {            $('#peso_tara-element').hide();            $('#peso_tara-label').hide();            $('#peso_bruto-label').show();            $('#peso_bruto-element').show();        } else {            $('#peso_tara-element').show();            $('#peso_tara-label').show();            $('#peso_bruto-element').hide();            $('#peso_bruto-label').hide();        }        /*ao editar oculto os campos*/        if ($('#data_entrada').val() !== '') {            $('#data_entrada-element').hide();            $('#data_entrada-label').hide();            subCategorias($('#categoria').val(), $('#subcategoria').val());            //$('#subcategoria').attr('readonly', true);        } else {            $('#data_saida-element').hide();            $('#data_saida-label').hide();        }    }    /*verifico os valores para ocultar e exibir os campos*/    if ($('#categoria :selected').text() == 'Carga Viva') {        $('#cabecas-label').show();        $('#cabecas-element').show();        $('#peso_tara').attr('readonly', true);        $('#peso_bruto').attr('readonly', true);            } else if ($('#categoria :selected').text() == 'Matéria-Prima'){        $('#peso_nota-label').show();        $('#peso_nota-element').show();        $('#cabecas-label').hide();        $('#cabecas-element').hide();         $('#peso_tara').attr('readonly', false);        $('#peso_bruto').attr('readonly', false);    } else {        $('#cabecas-label').hide();        $('#cabecas-element').hide();        $('#peso_nota-label').hide();        $('#peso_nota-element').hide();        $('#peso_tara').attr('readonly', false);        $('#peso_bruto').attr('readonly', false);    }    /*ao selecionare a opção do radio button oculto e exibo os campos*/    $(':radio').click(function () {        if ($(this).val() == '1') {            $('#peso_tara-element').hide();            $('#peso_tara-label').hide();            $('#peso_bruto-label').show();            $('#peso_bruto-element').show();            /*Ao editar limpo os campos*/            if ($('#id').val() == '') {                $('#peso_tara').val('');            }        } else {            $('#peso_tara-element').show();            $('#peso_tara-label').show();            $('#peso_bruto-element').hide();            $('#peso_bruto-label').hide();            /*Ao editar limpo os campos*/            if ($('#id').val() == '') {                $('#peso_bruto').val('');            }        }    });    /*oculto e exibo os campos ao selecionar as opções*/    $("#categoria").change(function () {        subCategorias($(this).val());        if ($('#categoria :selected').text() == 'Carga Viva') {            $('#cabecas-label').show();            $('#cabecas-element').show();            $('#peso_tara').attr('readonly', true);            $('#peso_bruto').attr('readonly', true);        } else if ($('#categoria :selected').text() == 'Matéria-Prima') {            $('#peso_nota-label').show();            $('#peso_nota-element').show();            $('#cabecas-label').hide();            $('#cabecas-element').hide();            $('#peso_tara').attr('readonly', false);            $('#peso_bruto').attr('readonly', false);        } else {            $('#cabecas-label').hide();            $('#cabecas-element').hide();            $('#peso_nota-label').hide();            $('#peso_nota-element').hide();            $('#peso_tara').attr('readonly', false);            $('#peso_bruto').attr('readonly', false);        }    });    /*insiro a mscara no campo de total de cabeças*/    $(function () {        $('#cabecas').bind('keydown', soNums);    });    /*Se existir valo no campo nota fiscal*/    if ($('#nota_fiscal').val() == '') {        $("#caminhao, #nota_fiscal").blur(function () {            var caminhao = $('#caminhao').val();            var nota = $('#nota_fiscal').val();            if (caminhao !== '' && nota !== '') {                $.ajax({                    url: '/admin/cargas/ajax-verifica-nota',                    data: {                        placa: caminhao,                        nota: nota                    },                    type: 'POST'                }).done(function (data) {                    if (data == true) {                        alerta('Não é possível inserir o mesmo Nº de nota fiscal para o mesmo veículo!');                        $('input[type="submit"]').prop('disabled', true);                    } else {                        $('input[type="submit"]').prop('disabled', false);                    }                });            }        });        /*ao selecionar o caminhão executo o ajax para verificar o numeor da nota*/        $("#caminhao").change(function () {            var caminhao = $('#caminhao').val();            var nota = $('#nota_fiscal').val();            if (caminhao !== '' && nota !== '') {                $.ajax({                    url: '/admin/cargas/ajax-verifica-nota',                    data: {                        placa: caminhao,                        nota: nota                    },                    type: 'POST'                }).done(function (data) {                    if (data == true) {                        alerta('Não é possível inserir o mesmo Nº de nota fiscal para o mesmo veículo!');                        $('input[type="submit"]').prop('disabled', true);                    } else {                        $('input[type="submit"]').prop('disabled', false);                    }                });            }        });    } else {        $('#nota_fiscal').prop('disabled', true);    }    /*ajax que abre a modal para inclusão de dados*/    $(document).on("click", ".incluirCaminhao", function () {        $.ajax({            url: '/admin/geral/ajax-incluir/param/2',            type: 'GET',            dataType: 'html'        }).done(function (data) {            $('.conteudo').html(data);            $('#myModal').modal('show');        });    });    $('#Salvar').click(function () {        $(this).attr("disabled", "disabled");        $('#FormCarga').submit();    });    /*ajax que abre a modal para inclusão de dados*/    $(document).on("click", ".incluirCategoria", function () {        $.ajax({            url: '/admin/geral/ajax-incluir/param/3',            type: 'GET',            dataType: 'html'        }).done(function (data) {            $('.conteudo').html(data);            $('#myModal').modal('show');        });    });    /*Capturo o peso da balança*/    $(document).on("click", ".bt_inclui_peso_bruto", function () {        $('#loader').remove();        $('#peso_bruto-element').after('<img id="loader" src="/adm/default/img/ajax-loader.gif"/>');        $.ajax({            url: '/admin/cargas/ajax-peso/',            type: 'POST'        }).done(function (data) {            $('#loader').remove();            if (data === 'erro') {                $('#peso_bruto').val('0.00');                $('#peso_bruto').attr('readonly', false);                alerta('Não foi possível capturar o peso');            } else {                $('#peso_bruto').val(data);                $('#peso_bruto').attr('readonly', true);            }        });    });    /* ao clicar limpo o campo peso bruto */    $(document).on("click", ".bt_limpa_peso_bruto", function () {        $('#loader').remove();        $('#peso_bruto').val("");    });    /*Capturo o peso da balança*/    $(document).on("click", ".bt_inclui_peso_tara", function () {        $('#loader').remove();        $('#peso_tara-element').after('<img id="loader" src="/adm/default/img/ajax-loader.gif"/>');        $.ajax({            url: '/admin/cargas/ajax-peso/',            type: 'POST'        }).done(function (data) {            $('#loader').remove();            if (data === 'erro') {                $('#peso_tara').val('0.00');                $('#peso_tara').attr('readonly', false);                alerta('Não foi possível capturar o peso');            } else {                $('#peso_tara').val(data);                $('#peso_tara').attr('readonly', true);            }        });    });    /* ao clicar limpo o campo peso tara */    $(document).on("click", ".bt_limpa_peso_tara", function () {        $('#loader').remove();        $('#peso_tara').val("");    });});/*Função que exibe mensagens de notificações*/function msg(title, msg) {    Notification.requestPermission(function () {        var notification = new Notification(title, {            icon: '/adm/default/img/atencion.svg',            body: msg        });    });}/*função de alert personalizado*/function alerta(msg) {    $("#mensagem").html("<p>" + msg + "</p>");    $("#mensagem").dialog({        modal: true,        buttons: {            Ok: function () {                $(this).dialog("close");            }        }    });    $("#mensagem").dialog("open");}/*função de apenas inteiros*/function soNums(e) {    //teclas adicionais permitidas (tab,delete,backspace,setas direita e esquerda)    keyCodesPermitidos = new Array(8, 9, 37, 39, 46);    //numeros e 0 a 9 do teclado alfanumerico    for (x = 48; x <= 57; x++) {        keyCodesPermitidos.push(x);    }    //numeros e 0 a 9 do teclado numerico    for (x = 96; x <= 105; x++) {        keyCodesPermitidos.push(x);    }    //Pega a tecla digitada    keyCode = e.which;    //Verifica se a tecla digitada é permitida    if ($.inArray(keyCode, keyCodesPermitidos) != -1) {        return true;    }    return false;}/*Função que lista as subcategorias conforma a categoria selecionada*/function subCategorias($valor, $edita) {    // Limpo os Valores da Subcategoria    $("#subcategoria > option").remove();    // Se valor (da categoria) for Maior do que 0    if ($valor > 0) {        // Busco via JSON os dados da SUBCATEGORIA        $.getJSON('/admin/categorias/ajax-sub-categorias/categoria/' + $valor, function (data) {            if (data.length > 0) {                var itens = [];                $.each(data, function (key, val) {                    var selecionado = '';                    if ($edita == data[key].id) {                        selecionado = 'selected';                    }                    itens.push('<option value="' + data[key].id + '" ' + selecionado + '>' + data[key].nome + '</option>');                });                $("#subcategoria").append(itens.join('')).removeAttr('readonly'); // Adiciono as OPTIONS retornadas                $('#subcategoria-label').show();                $('#subcategoria-element').show();            } else {                $('#subcategoria-label').hide();                $('#subcategoria-element').hide();            }        });    }}/* function SelecionaSubCategoria(categoria) { $.getJSON('/admin/categorias/ajax-sub/categoria/' + categoria, function (data) { $("#subcategoria").removeAttr('disabled'); var html = ""; $(data).each(function (i, e) { if ($("#sub").val() === e.id) { var check = 'selected'; } else { var check = ''; } html += '<option value="' + e.id + '" ' + check + '>' + e.nome + '</option>'; }); //console.log(html); $('#subcategoria').html(html);   }); } */